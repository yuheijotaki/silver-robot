---
title: satoriとsharpで記事ごとにog:imageを生成する
description: satoriとsharpを使ってog:imageを生成したメモです。
pubDate: 2024-04-01T00:00:00.000Z
---

## はじめに

[satori](https://github.com/vercel/satori) と [sharp](https://sharp.pixelplumbing.com/) を使用して記事ページごとのog:image画像を作成する。

## 手順

### インストール

`satori` `sharp` をインストール。  
Reactのインテグレーションも行う。

### 画像ファイルのエンドポイントを作成

[src/pages/og/[slug].png.ts](https://github.com/yuheijotaki/yuheijotaki.com/blob/main/src/pages/og/%5Bslug%5D.png.ts)

### 画像を生成

[src/components/OgImage.tsx](https://github.com/yuheijotaki/yuheijotaki.com/blob/main/src/components/OgImage.tsx)

HTML/CSSをsatoriでSVGへ書き出し、sharpでPNGに変換。  
[Vercel OG Image Playground](https://og-playground.vercel.app/) などを使うと便利かも。

### 画像指定の変更

`og:image` や `twitter:image` のパス指定を変更する。

## 結果

この記事のog:imageは次のようになる。

![記事タイトルが入った生成画像](/og/2024040101_satori-og-image.png)

## ひとこと

- 背景画像を用意して下に敷いたほうがよいデザインの場合もある
- フォントの指定はWebフォント or ローカルに置いたものを指定する
- `-webkit-line-clamp` での行数制限がうまく効かなかったため、文字数で切り取っている
